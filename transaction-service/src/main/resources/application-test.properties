# ============================================================================
# src/test/resources/application-test.properties
# Configuration pour les tests unitaires et d'intégration
# ============================================================================

# ========================================================================
# CACHE - Désactivation pour les tests
# ========================================================================
spring.cache.type=none
rag.cache-enabled=false

# ========================================================================
# JPA / HIBERNATE - Configuration minimale pour les tests
# ========================================================================
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.sql.init.mode=never

# ========================================================================
# PGVECTOR - Configuration de test (connexion factice)
# ========================================================================
pgvector.host=localhost
pgvector.port=5432
pgvector.database=test_vectordb
pgvector.user=admin
pgvector.password=1234
pgvector.dimension=1536
pgvector.connection.pool.size=2
pgvector.connection.timeout=10

# ========================================================================
# OPENAI - Clé API factice pour les tests
# ========================================================================
openai.api.key=sk-test-mock-key-for-testing-only
openai.embedding.model=text-embedding-3-small
openai.chat.model=gpt-4o
openai.temperature=0.7
openai.max.tokens=2000
openai.timeout.seconds=30
openai.max.retries=1
openai.log.requests=false
openai.log.responses=false

# ========================================================================
# RAG - Configuration simplifiée pour les tests
# ========================================================================
rag.min-score=0.6
rag.max-retries=1
rag.retry-delay-ms=100
rag.parallel-search-threads=2
rag.tools.max-document-results=3
rag.tools.max-image-results=2
rag.tools.max-multimodal-results=3
rag.tools.min-query-length=1
rag.tools.max-query-length=1000
rag.tools.max-result-text-length=500
rag.tools.show-metrics=false

# ========================================================================
# ASSISTANT - Configuration pour les tests
# ========================================================================
assistant.upload.max-file-size=5242880
assistant.upload.allowed-extensions=pdf,png,jpg,txt
assistant.chat.max-message-length=1000
assistant.chat.min-message-length=1
assistant.chat.timeout-seconds=30
assistant.stream.timeout-seconds=60
assistant.stream.heartbeat-interval-seconds=30

# ========================================================================
# CORS - Configuration pour les tests
# ========================================================================
app.cors.allowed-origins=http://localhost:4200

# ========================================================================
# LOGGING - Niveau de log pour les tests
# ========================================================================
logging.level.root=WARN
logging.level.com.exemple.transactionservice=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.dev.langchain4j=WARN

# ========================================================================
# SPRING BOOT - Désactiver certaines auto-configurations pour les tests
# ========================================================================
spring.autoconfigure.exclude=\
  org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
  org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration